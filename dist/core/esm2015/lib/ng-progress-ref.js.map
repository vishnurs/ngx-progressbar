{
  "version": 3,
  "file": "ng-progress-ref.js",
  "sources": [
    "ng://@ngx-progressbar/core/projects/core/src/lib/ng-progress-ref.ts"
  ],
  "sourcesContent": [
    "import { NgProgressState, NgProgressConfig } from './ng-progress.interface';\nimport { Observable, Subject, BehaviorSubject, timer, of, combineLatest } from 'rxjs';\nimport { tap, map, skip, delay, filter, debounce, switchMap, distinctUntilChanged } from 'rxjs/operators';\n\nexport class NgProgressRef {\n\n  private _state: NgProgressState = {active: false, value: 0};\n  private _config: NgProgressConfig;\n\n  /** Stream that increments and updates progress state */\n  private _trickling$ = new Subject();\n\n  /** Stream that emits when progress state is changed */\n  state$ = new BehaviorSubject<NgProgressState>(this._state);\n\n  /** Stream that emits when config is changed */\n  config$ = new Subject<NgProgressConfig>();\n\n  get isStarted(): boolean {\n    return this._state.active;\n  }\n\n  /** Progress start event */\n  get started(): Observable<boolean> {\n    return this.state$.pipe(\n      map((state: NgProgressState) => state.active),\n      distinctUntilChanged(),\n      filter(active => active)\n    );\n  }\n\n  /** Progress ended event */\n  get completed(): Observable<boolean> {\n    return this.state$.pipe(\n      map((state: NgProgressState) => state.active),\n      distinctUntilChanged(),\n      filter(active => !active),\n      skip(1)\n    );\n  }\n\n  constructor(customConfig: NgProgressConfig) {\n\n    combineLatest(this._trickling$, this.config$).pipe(\n      debounce(([start, config]: [boolean, NgProgressConfig]) => timer(start ? this._config.debounceTime : 0)),\n      switchMap(([start, config]: [boolean, NgProgressConfig]) => start ? this._trickling(config) : this._complete(config))\n    ).subscribe();\n\n    this.setConfig(customConfig);\n  }\n\n  start() {\n    this._trickling$.next(true);\n  }\n\n  complete() {\n    this._trickling$.next(false);\n  }\n\n  inc(amount?: number) {\n    const n = this._state.value;\n    if (!this.isStarted) {\n      this.start();\n    } else {\n      if (typeof amount !== 'number') {\n        amount = this._config.trickleFunc(n);\n      }\n      this.set(n + amount);\n    }\n  }\n\n  set(n: number) {\n    this._setState({value: this._clamp(n), active: true});\n  }\n\n  setConfig(config: NgProgressConfig) {\n    this._config = {...this._config, ...config};\n    this.config$.next(this._config);\n  }\n\n  /**\n   * Meant to be used internally and not by user directly\n   * Users should use NgProgressManager.destroy(id) instead\n   */\n  destroy() {\n    this._trickling$.complete();\n    this.state$.complete();\n    this.config$.complete();\n  }\n\n  private _setState(state: NgProgressState) {\n    this._state = {...this._state, ...state};\n    this.state$.next(this._state);\n  }\n\n  /** Clamps a value to be between min and max */\n  private _clamp(n): number {\n    return Math.max(this._config.min, Math.min(this._config.max, n));\n  }\n\n  /** Keeps incrementing the progress */\n  private _trickling(config: NgProgressConfig) {\n    if (!this.isStarted) {\n      this.set(this._config.min);\n    }\n    return timer(0, config.trickleSpeed).pipe(tap(() => this.inc()));\n  }\n\n  /** Completes then resets the progress */\n  private _complete(config: NgProgressConfig) {\n    return !this.isStarted ? of({}) : of({}).pipe(\n      // Completes the progress\n      tap(() => this._setState({value: 100})),\n\n      // Hides the progress bar after a tiny delay\n      delay(config.speed * 1.7),\n      tap(() => this._setState({active: false})),\n\n      // Resets the progress state\n      delay(config.speed),\n      tap(() => this._setState({value: 0}))\n    );\n  }\n}\n"
  ],
  "names": [],
  "mappings": "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"
}
